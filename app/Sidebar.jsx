'use client';
import { useEffect, useState } from 'react';
import styles from './layout.module.scss'
import { Router } from 'next/router'
import { useSession , signIn , signOut } from 'next-auth/react'

export default function Sidebar() {
  const [current,setCurrent]=useState("/")
  const {session} = useSession()
  function changePage(link){
    setCurrent(link)
    window.location.href=(link)
  }

  useEffect(()=>setCurrent(window.location.href.substring(window.location.href.lastIndexOf('/') + 1)),[])
  

  return (
    <div className={styles.navbar}>
        <div className={styles.header}>
          {/* <img src="assets/sidebar/logo.svg" alt="" /> */}
          <Icon name="logo"/>
          <span/>
          <p>NGS</p>
        </div>
        <div className={styles.tools}>
          <Icon title="Map" name="map" active={current==""} onClick={()=>changePage("/")}/>
          <Icon title="Coming Soon" name="unreleased"/>
          <Icon title="Coming Soon" name="unreleased"/>
        </div>        
        <span/>
        <div className={styles.info}>
          <div data-title="Celestial"><img src="assets/sidebar/celestial.png" alt="" /></div>
          <Icon title="Whats New" name="info"/>         
          <Icon title="Support Us!" name="heart"/>         
        </div>        
        <span/>
        <div className={styles.settings}>
          <Icon title="Editor" name="collab" active={current=="collab"} onClick={()=>changePage("collab")}/>  
          <div data-title="Dark Mode"><img src="assets/sidebar/theme.png" alt="" /></div>
          {/* <Icon title="Settings" name="settings"/>
          <section className={styles.settingsMenu}>            
          </section> */}
          <div data-title="User"><img src="assets/sidebar/user.png" alt="" /></div>
          <section className={styles.userMenu}>    
            {
              session?<></>:
              <div className={styles.login}>                        
                <h2>Welcome Back</h2>
                <div className={styles.loginProvider} onClick={()=>{
                  signIn('google')
                }}>
                  <img src="assets/sidebar/google.png" alt="" />
                  <p>Sign in with Google</p>
                  <span/>
                </div>
              </div>
            }
          </section>
        </div>
        <div className={styles.footer}>
          <p>V2.0</p>
        </div>
    </div>  
  )
}

export function Icon({title,name,active=false,fill="#9C9C9C",fill2="#363636",onClick}){  
  const icons={
    logo:(<path d="M522.693 448.886V265.038q0-12.546 8.327-20.791 8.327-8.246 20.636-8.246h239.543q12.309 0 20.554 8.246 8.246 8.245 8.246 20.791v183.848q0 12.546-8.327 20.791-8.327 8.245-20.636 8.245H551.493q-12.309 0-20.555-8.245-8.245-8.245-8.245-20.791ZM140.001 559.998V264.686q0-12.194 8.327-20.439 8.327-8.246 20.636-8.246h239.543q12.309 0 20.555 8.25 8.245 8.249 8.245 20.444v295.311q0 12.195-8.327 20.44-8.327 8.245-20.636 8.245H168.801q-12.309 0-20.554-8.249-8.246-8.249-8.246-20.444Zm382.692 327.308V591.994q0-12.195 8.327-20.44 8.327-8.245 20.636-8.245h239.543q12.309 0 20.554 8.249 8.246 8.249 8.246 20.444v295.312q0 12.194-8.327 20.439-8.327 8.246-20.636 8.246H551.493q-12.309 0-20.555-8.25-8.245-8.249-8.245-20.443Zm-382.692-.344V703.114q0-12.546 8.327-20.791 8.327-8.245 20.636-8.245h239.543q12.309 0 20.555 8.245 8.245 8.245 8.245 20.791v183.848q0 12.546-8.327 20.791-8.327 8.246-20.636 8.246H168.801q-12.309 0-20.554-8.246-8.246-8.245-8.246-20.791Zm45.384-343.655h206.538V281.385H185.385v261.922Zm382.692 327.308h206.538V608.693H568.077v261.922Zm0-438.076h206.538V281.385H568.077v151.154ZM185.385 870.615h206.538V719.461H185.385v151.154Zm206.538-327.308Zm176.154-110.768Zm0 176.154ZM391.923 719.461Z"/>),
    
    map:(<path d="m589.692 907.845-237.615-84.077-167.076 65.999q-15.461 7.847-30.23-1.192-14.77-9.038-14.77-27.115V338.463q0-11.847 6.347-21.27 6.346-9.423 17.192-13.653l169.306-59.385q9.231-2.615 19.039-2.615 9.808 0 19.423 2.615l237.615 83.077 166.076-65.615q15.461-7.231 30.23.923 14.77 8.154 14.77 25.846v531.151q0 10.616-6.923 18.424-6.924 7.807-17.154 11.423l-168.153 58.845q-9.231 3-18.846 2.616-9.616-.385-19.231-3ZM583 857.923V362.924l-206-70.231v494.999l206 70.231Zm45.384 0 146.231-48.154V307.77l-146.231 55.154v494.999ZM185.385 843.23l146.231-55.538V292.693l-146.231 48.923V843.23Zm442.999-480.306v494.999-494.999Zm-296.768-70.231v494.999-494.999Z"/>),

    unreleased:(<path d="M443.693 719.461q.616-61.23 17.077-95.576 16.462-34.346 63.308-76.039 39.692-35.692 60.269-68.192 20.577-32.5 20.577-70.269 0-50.385-34.039-83.655-34.039-33.269-93.808-33.269-52.385 0-81.923 26.423-29.539 26.422-46.001 60.346l-58.998-27q23.923-53.615 70.654-87.999 46.73-34.384 116.268-34.384 93.076 0 143.614 52.423 50.539 52.423 50.539 124.653 0 45.692-19.731 83.923t-60.115 75.846q-52.077 47.769-64.193 75.654-12.115 27.885-12.731 77.115h-70.767Zm33.384 236.538q-21.692 0-37.192-15.5-15.499-15.5-15.499-37.192 0-21.691 15.499-37.191 15.5-15.5 37.192-15.5t37.191 15.5q15.5 15.5 15.5 37.191 0 21.692-15.5 37.192-15.499 15.5-37.191 15.5Z"/>),

    info:(<path d="m394.385 701.309 54.804-119.197 119.197-54.804-119.197-54.682-54.804-118.934-54.682 118.934-118.934 54.682 118.934 54.804 54.682 119.197Zm0 109.613-88.461-194.768-195.153-88.846 195.153-88.461 88.461-195.153 88.846 195.153 194.768 88.461-194.768 88.846-88.846 194.768Zm312.844 97.384-43.754-98.125-97.86-43.875 97.691-44.538 43.923-97.076 44.923 97.076 97.077 44.538-97.125 43.875-44.875 98.125ZM394.385 527.308Z"/>),

    heart:(<path d="m440.923 874.614-46.076-42.462Q275.078 722.153 187.54 621.884q-87.539-100.269-87.539-206.576 0-82.307 55.5-137.807 55.5-55.5 137.192-55.5 46.768 0 96.191 23.731T480 332.002q45.154-62.539 92.346-86.27 47.193-23.731 94.961-23.731 81.692 0 137.192 55.5 55.5 55.5 55.5 137.807 0 107.461-89.462 208.307-89.461 100.846-205.384 208.153l-46.076 42.461Q502.461 889.075 480 889.267q-22.461.193-39.077-14.653Zm19.231-491.998q-31.231-55.539-75.231-85.385-44-29.846-92.23-29.846-64.462 0-105.885 41.731-41.423 41.73-41.423 106.192 0 52.615 32.461 108.807 32.461 56.191 81.268 111.768 48.808 55.577 106.038 107.846 57.231 52.269 106.77 97.27 3.462 3.462 8.078 3.462t8.078-3.462q49.539-44.385 106.77-96.962 57.23-52.577 106.038-108.462 48.807-55.884 81.268-112.076 32.461-56.192 32.461-108.191 0-64.462-41.731-106.192-41.73-41.731-105.577-41.731-49.23 0-92.73 29.538-43.5 29.539-75.962 85.693-3.846 6.077-8.692 9t-10.538 2.923q-6.077 0-11.231-2.923t-8-9ZM480 556.307Z"/>),

    settings:(<path d="m400.693 955.999-18.077-120.231q-20.538-7-44.231-20.346-23.692-13.346-40.846-28.27l-111.846 50.923-79.922-141.306 101.077-74.384q-2-10.539-2.885-23-.885-12.462-.885-23 0-10.154.885-22.616t2.885-24.154l-101.077-74.769 79.922-140.152 111.461 50.154q18.308-14.924 41.231-28.078 22.924-13.154 43.847-19.538l18.461-121.231h158.614l18.077 120.615q22.077 8.154 44.154 20.231 22.077 12.077 39.769 28.001l113.384-50.154 79.538 140.152-102.615 74.308q2.769 11.923 3.462 24 .692 12.077.692 22.846 0 10.385-.885 22.154-.884 11.769-3.269 24.462l102.23 74.153-79.922 141.306-112.615-51.307q-18.692 15.692-40.346 28.962-21.654 13.269-43.577 19.654l-18.077 120.615H400.693Zm78.153-267.308q47.076 0 79.884-32.807 32.807-32.808 32.807-79.884t-32.807-79.884q-32.808-32.807-79.884-32.807-46.692 0-79.691 32.807-33 32.808-33 79.884t33 79.884q32.999 32.807 79.691 32.807Zm0-45.384q-27.846 0-47.577-19.73-19.73-19.731-19.73-47.577 0-27.846 19.73-47.577 19.731-19.73 47.577-19.73 28.231 0 47.769 19.73 19.539 19.731 19.539 47.577 0 27.846-19.539 47.577-19.538 19.73-47.769 19.73ZM480 576Zm-42.846 334.615h85.307L536.846 799q31.846-8 59.423-23.846 27.577-15.847 52.731-40.231l104.461 45.231 40-70.847L701 641.077q4-17.77 6.307-33.5 2.308-15.731 2.308-31.577 0-16.615-2-31.961T701 511.693l93.23-69-40-70.847-105.615 45.231q-21.077-23.692-50.846-41.769Q568 357.231 536.461 353l-13.615-111.615h-85.692l-13.231 111.231q-33.23 6.615-61.192 22.653-27.961 16.039-52.115 41.424L205.77 371.846l-40 70.847 92.461 67.846q-4.385 15.846-6.692 32.153-2.308 16.308-2.308 33.693 0 16.615 2.308 32.538 2.307 15.923 6.307 32.154l-92.076 68.23 40 70.847 104.461-44.847q24 24.385 52.154 40.231 28.154 15.846 61.154 23.846l13.615 111.231Z"/>),

    collab:(<path d="M729.845 462.693 592.923 326.155l64.999-64.615q16.616-16.615 40.462-16.615 23.846 0 40.461 16.615l55.615 55.999q16.615 16.616 16.615 40.462 0 23.846-16.615 40.077l-64.615 64.615ZM137.309 918.306V780.385l190.923-190.923-218.308-219.308 155.922-157.152 220.308 219.923 106.769-106.77 136.922 136.538L623.46 569.846l219.538 220.308-156.537 154.922-219.692-218.308-191.538 191.538H137.309Zm223.537-361.074 92.693-92.693-80.308-80.693-47.616 48-31.999-31.999 47.615-47.615-74.77-74.77-92.692 92.692 187.077 187.078Zm324 324.614 92.692-92.692-74.77-74.77-47.615 47.615L623.154 730l47.615-47.615-80.308-80.309-92.693 92.693 187.078 187.077Zm-502.153-8.923h72.692l409.23-409.23L591.923 391l-409.23 409.23v72.693Z"/>)
  }

  return (
    <div data-title={title} className={styles.sidebarSVG+(active?" "+styles.active:"")} onClick={onClick}>
      <svg xmlns="http://www.w3.org/2000/svg" fill={active?fill2:fill} width="100%" viewBox="0 96 960 960" >
        {Object.keys(icons).includes(name)?icons[name]:`?${name}`}
      </svg>
    </div>    
  )
}
